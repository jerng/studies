<html> 
<head> 
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>
<script type="text/javascript" src="https://github.com/DmitryBaranovskiy/raphael/raw/1.0/raphael-min.js"></script>
<script>
  $(document).ready(function(){
    
    // Catch input data.

    window.data = {
        'timegraph':{
            'header':'Development of My Interests',
            'startdate':'1992/01/01',
            'enddate':'2011/12/31',
            'moments':[
                {
                  'date':'1991/12/31',
                  'label':'KTGPs'
                },
                {
                  'date':'1997/12/31',
                  'label':'MMWC'
                },
                {
                  'date':'2002/12/31',
                  'label':'CBCC'
                }
              ],
            'periods':[
                {
                  'startdate':'1993/01/01',
                  'enddate':'2007/12/01',
                  'label':'',
                  'displayrow':1,
                  'archeightfraction':0.99
                },
                {
                  'startdate':'1993/01/01',
                  'enddate':'1995/06/01',
                  'label':'',
                  'displayrow':2,
                  'archeightfraction':0.50
                },
                {
                  'startdate':'2003/01/01',
                  'enddate':'2010/12/01',
                  'label':'',
                  'displayrow':2,
                  'archeightfraction':0.99
                },
                {
                  'startdate':'1994/01/01',
                  'enddate':'1998/03/01',
                  'label':'',
                  'displayrow':3,
                  'archeightfraction':0.65
                },
                {
                  'startdate':'1999/02/01',
                  'enddate':'2000/08/01',
                  'label':'',
                  'displayrow':3,
                  'archeightfraction':0.20
                },
                {
                  'startdate':'2002/01/01',
                  'enddate':'2007/12/01',
                  'label':'',
                  'displayrow':3,
                  'archeightfraction':0.99
                },
                {
                  'startdate':'2009/08/01',
                  'enddate':'2011/03/01',
                  'label':'',
                  'displayrow':3,
                  'archeightfraction':0.20
                },
                {
                  'startdate':'2009/08/01',
                  'enddate':'2011/03/01',
                  'label':'',
                  'displayrow':4,
                  'archeightfraction':0.35
                },
                {
                  'startdate':'1995/09/01',
                  'enddate':'1998/06/01',
                  'label':'',
                  'displayrow':4,
                  'archeightfraction':0.50
                },
                {
                  'startdate':'2000/05/01',
                  'enddate':'2004/03/02',
                  'label':'',
                  'displayrow':4,
                  'archeightfraction':0.65
                },
                {
                  'startdate':'2006/01/01',
                  'enddate':'2009/06/01',
                  'label':'',
                  'displayrow':4,
                  'archeightfraction':0.50
                },
                {
                  'startdate':'2001/01/01',
                  'enddate':'2003/12/01',
                  'label':'',
                  'displayrow':5,
                  'archeightfraction':0.65
                },
                {
                  'startdate':'2004/01/01',
                  'enddate':'2008/12/01',
                  'label':'',
                  'displayrow':5,
                  'archeightfraction':0.65
                },
                {
                  'startdate':'2003/01/01',
                  'enddate':'2006/03/01',
                  'label':'',
                  'displayrow':6,
                  'archeightfraction':0.50
                },
                {
                  'startdate':'2000/09/01',
                  'enddate':'2003/01/01',
                  'label':'',
                  'displayrow':6,
                  'archeightfraction':0.33
                },
		            {
		              'startdate':'2000/01/01',
                  'enddate':'2000/06/01',
                  'label':'',
                  'displayrow':7,
                  'archeightfraction':0.10
                },
                {
                  'startdate':'2006/09/01',
                  'enddate':'2007/03/01',
                  'label':'',
                  'displayrow':7,
                  'archeightfraction':0.10
                },
                {
                  'startdate':'2008/10/01',
                  'enddate':'2009/03/01',
                  'label':'',
                  'displayrow':7,
                  'archeightfraction':0.10
                },
              ]
          },
        'partsgraph':{
            'header':'Professional Specialty',
            'parts': [
              {
                'label':'TYPOGRAPHY',
                'fraction':0.3
              },
              {
                'label':'INFOGRAPHIC',
                'fraction':0.2
              },
              {
                'label':'ILLUSTRATION',
                'fraction':0.15
              },
              {
                'label':'BRANDING',
                'fraction':0.1
              },
              {
                'label':'BOOK ART',
                'fraction':0.1
              },
              {
                'label':'VIDEO',
                'fraction':0.075
              },
              {
                'label':'WEBSITE',
                'fraction':0.075
              }
            ]
          },
        'textcolumns':{
            'left':{
                'sections':[
                    {
                      'type':0,
                      'header':'Introduction',
                      'text':"I am Chester, 23 years old, I have engaged in the design field in Hong Kong and trying to develop my career by gaining recognition both in local and international over 4 years.\n\nMainly focus on information design, typography, illustration and branding.</p>"
                    },
                    {
                      'type':1,
                      'header':'Education Qualification',
                      'rows':[
                          {
                            'header':'Caritas Bianchi College of Careers',
                            'text':[
                                "$Associate Degree in Design\nLevel 5BTEC HNDs",
                                'Graphic Design',
                                '2003 - 2006'
                              ]
                          },
                          {
                            'header':'C.C.C. Mong Man Wai College',
                            'text':[
                                "Associate Degree in Design\nLevel 5BTEC HNDs",
                                '',
                                '1998 - 2003'
                              ]
                          }
                        ] // rows
                    },
                    {
                      'type':0,
                      'header':'Computer Skill',
                      'text':'Photoshop, Illustration, Painter, Lightroom, Flash, Motion, AfterEffects, Final Cut Pro, Soundtrack Pro, Logic Pro, Microsoft Office, Keynote'
                    },
                    {
                      'type':2,
                      'header':'Publish / Awards / Exhibition',
                      'floatsection':[
                          {
                            'header':'Designprozess Competition 2008',
                            'subheader':'by DCKD (Germany & China)',
                            'text':'Open Category - Outstanding Award'
                          },
                          {
                            'header':'Megaboxing Day 2007',
                            'subheader':'by MEGABOX & POPM (Hong Kong)',
                            'text':'Charity Exhibition'
                          },
                          {
                            'header':'Bastardised 2008',
                            'subheader':'by BUNCH (London)',
                            'text':"Book Launch at London,\nZagreb & Singapore"
                          },
                          {
                            'header':'Bla bla bra Graphic Design Contest 2007',
                            'subheader':'by BLABLABRA (Hong Kong)',
                            'text':'Open Category - Certificate of Merit'
                          }
                        ]
                    }
                  ] // sections 
              },
            'right':{
                'sections':[
                    {
                      'type':3,
                      'header':'Self Development',
                      'subsections':[
                          {
                            'header':'Branding',
                            'rows':[
                                {
                                  'text':[
                                      'Waaichun Company',
                                      '2007 - current'
                                    ]
                                },
                                {
                                  'text':[
                                      'Nomad Company',
                                      '2007 - current'
                                    ]
                                },
                                {
                                  'text':[
                                      'TY Healthcare Corporation Limited',
                                      '2006 - 2008'
                                    ]
                                }
                              ] // rows
                          },
                          {
                            'header':'Design & Marketing',
                            'rows':[
                                {
                                  'text':[
                                      'Nom.com.hk',
                                      '2009'
                                    ]
                                },
                                {
                                  'text':[
                                      'IPTV International Corporation Limited',
                                      '2008'
                                    ]
                                },
                                {
                                  'text':[
                                      'Waaichun Company',
                                      '2007 - current'
                                    ]
                                },
                                {
                                  'text':[
                                      'Nomad Company',
                                      '2007 - current'
                                    ]
                                },
                                {
                                  'text':[
                                      'Healthy Pharmaceutical Company',
                                      '2007'
                                    ]
                                },
                                {
                                  'text':[
                                      'Infraco International Corporation Limited',
                                      '2007'
                                    ]
                                },
                                {
                                  'text':[
                                      'TY Healthcare Corporation Limited',
                                      '2006 - 2008'
                                    ]
                                },
                                {
                                  'text':[
                                      'ProtectHK.com',
                                      '2006'
                                    ]
                                },
                                {
                                  'text':[
                                      'People Recreation Company',
                                      '2005 - 2006'
                                    ]
                                },
                                {
                                  'text':[
                                      'Graffiti Design & Exhibition Service Company',
                                      '2004'
                                    ]
                                }
                              ]
                          },
                          {
                            'header':'Perosnal Creation',
                            'rows':[
                                {
                                  'text':[
                                      'Waaichun Greeting',
                                      '2008'
                                    ]
                                },
                                {
                                  'text':[
                                      'Repression',
                                      '2007 - current'
                                    ]
                                },
                                {
                                  'text':[
                                      'Bulooji & Malaafa',
                                      '2006 - current'
                                    ]
                                }
                              ]
                          }
                        ] // subsections
                    }
                  ] // sections
              } // right
          } // textcolumns
      }; // data
   
    // Set application configuration.

    window.app = {
        'dns':{ // Absolute dimensions of paper in px.
            'width':210, // currently models A4
            'height':297,
            'margin':16.2422,
            'timegraphArcsHeight':25.2334,
            'timegraphBarsHeight':35.6748,
            'timegraphBarsPaddingTop':4.6406,
            'timegraphBarHeight':2.6104,
            'timegraphBarVerticalSpacing':2.0303,
            'textindent':2,
            'multiplier':6// currently fills a notebook screen
          },
        'pgns' : {},
        'pths' : {},
        'texts' : {},
        'config' : 
        {
          'fontSize' : 10,
          'fontMargin' : 10,
          'timegraphRowColors':
          [
            "#00b5ff",//6ad4ff",
            "#00ff00",//ff9b37",
            "#ffe600",//807a43",//fff385",
            "#ff8900",//ff3d00",//ff9979",
            "#ff0000",//ff007a",//ff9dcc",
            "#c300d0",//d200ff",//f3bbff",
            "#0000ff",//9cffc7",
          ]
        },
        'built':{
            'timegraphArcs':[],
            'timegraphBars':[],
            'timegraphGuides':[]
          }
      };

    app.dns.m_width = app.dns.width * app.dns.multiplier;
    app.dns.m_height = app.dns.height * app.dns.multiplier;
    app.dns.m_margin = app.dns.margin * app.dns.multiplier;
      app.dns.mu_width = app.dns.m_width - (2 * app.dns.m_margin);
      app.dns.mu_height = app.dns.m_height - (2 * app.dns.m_margin);
    app.dns.m_timegraphArcsHeight = app.dns.timegraphArcsHeight * app.dns.multiplier;
    app.dns.m_timegraphBarsHeight = app.dns.timegraphBarsHeight * app.dns.multiplier;
    app.dns.m_timegraphBarsPaddingTop = app.dns.timegraphBarsPaddingTop * app.dns.multiplier;
    app.dns.m_timegraphBarHeight = app.dns.timegraphBarHeight * app.dns.multiplier;
    app.dns.m_timegraphBarVerticalSpacing = app.dns.timegraphBarVerticalSpacing * app.dns.multiplier;
    
    // Integrate application and data. 
    
    var tmpT = data.timegraph;
      tmpT.startdate = new Date(tmpT.startdate);
      tmpT.enddate = new Date(tmpT.enddate);
      tmpT.ms = tmpT.enddate - tmpT.startdate;

      var tmpArcBaseY = app.dns.m_margin + app.dns.m_timegraphArcsHeight;
      var tmpBarBaseY = app.dns.m_margin + app.dns.m_timegraphArcsHeight + app.dns.m_timegraphBarsPaddingTop; //todo:optimise from above
      var tmpPs = tmpT.periods;
      var tmpLen = tmpPs.length;
        for (var tmpI = 0; tmpI<tmpLen; tmpI++ )
        {
          tmpPs[tmpI].startdate = new Date(tmpPs[tmpI].startdate);
          tmpPs[tmpI].enddate = new Date(tmpPs[tmpI].enddate);
          tmpPs[tmpI].ms = tmpPs[tmpI].enddate - tmpPs[tmpI].startdate;
          // Absolute positions against paper, in px.
          tmpPs[tmpI].xstart = (tmpPs[tmpI].startdate - tmpT.startdate) / tmpT.ms * app.dns.mu_width;
          tmpPs[tmpI].xend = (tmpPs[tmpI].enddate - tmpT.startdate) / tmpT.ms * app.dns.mu_width;
          tmpPs[tmpI].xlength = tmpPs[tmpI].xend - tmpPs[tmpI].xstart;
          tmpPs[tmpI].arc = {
              'r' : {
                  'x':tmpPs[tmpI].xlength/2,
                  'y':tmpPs[tmpI].archeightfraction * app.dns.m_timegraphArcsHeight
                }
            };
          tmpPs[tmpI].arcPosition = {
              'x':{
                  'start':tmpPs[tmpI].xstart + app.dns.m_margin,
                  'end':tmpPs[tmpI].xend + app.dns.m_margin
                },
              'y':tmpArcBaseY
            };
          tmpPs[tmpI].barPosition = {
              'x':tmpPs[tmpI].xstart + app.dns.m_margin, // TODO:optimise from above later
              'y':tmpBarBaseY + (tmpPs[tmpI].displayrow - 1) * (app.dns.m_timegraphBarHeight + app.dns.m_timegraphBarVerticalSpacing)
            };
        };
      delete tmpI; delete tmpLen; delete tmpPs; delete tmpBarBaseY; delete tmpArcBaseY;

    delete tmpT; 

    // Fire paper.
    
    app['paper'] = Raphael('paper1',app.dns.m_width,app.dns.m_height);
      $('svg').each(function()
      {// Style the paper.
        var style_ = $(this).attr('style');
        style_ = (style_=='undefined'?'':style_)+';background-color:#fff;'; // combine with row above?
        $(this).attr('style',style_);
      });

    // Sketch the usable area.
/*
    app.pgns.usableBorder = app.paper.rect(
        app.dns.m_margin,
        app.dns.m_margin,
        app.dns.mu_width,
        app.dns.mu_height
      );
      app.pgns.usableBorder.attr({
          'stroke':'#ccc',
          'fill':'none'
        });
    app.pgns.timegraphBars = app.paper.rect(
        app.dns.m_margin,
        app.dns.m_margin + app.dns.m_timegraphArcsHeight,
        app.dns.mu_width,
        app.dns.m_timegraphBarsHeight
      );
      app.pgns.timegraphBars.attr({
          'stroke':'#00f',
          'fill':'none'
        });
*/
    
    // Graph timegraph.
    
    var tmpPs = data.timegraph.periods;
    var tmpLen = tmpPs.length;
      for (var tmpI = 0; tmpI<tmpLen; tmpI++ )
      {
        // arcs
        app.built.timegraphArcs[tmpI] = app.paper.path(
            'M'+tmpPs[tmpI].arcPosition.x.start+' '+tmpPs[tmpI].arcPosition.y
           +'A'+tmpPs[tmpI].arc.r.x+','+tmpPs[tmpI].arc.r.y+' 0 0,1 '+tmpPs[tmpI].arcPosition.x.end+','+tmpPs[tmpI].arcPosition.y
          );
        app.built.timegraphArcs[tmpI].attr({ //todo:optimise into .set()
            'stroke':'none',
            'fill':app.config.timegraphRowColors[tmpPs[tmpI].displayrow-1],
            'fill-opacity':0.3
          });
      };
      for (var tmpI = 0; tmpI<tmpLen; tmpI++ )
      {
        // guidelines linking arcs and bars
        app.built.timegraphGuides[tmpI] = 
        {
          'left' :  app.paper.path
          (
            'M'+tmpPs[tmpI].arcPosition.x.start+' '+tmpPs[tmpI].arcPosition.y+
            'V'+(tmpPs[tmpI].barPosition.y+app.dns.m_timegraphBarHeight)
          ),
          'right' :  app.paper.path
          (
            'M'+tmpPs[tmpI].arcPosition.x.end+' '+tmpPs[tmpI].arcPosition.y+
            'V'+(tmpPs[tmpI].barPosition.y+app.dns.m_timegraphBarHeight)
          )
        };
        app.built.timegraphGuides[tmpI].left.attr(
        {
          'stroke':'#eee',
          //'stroke-opacity':0.1
        });
        app.built.timegraphGuides[tmpI].right.attr(
        {
          'stroke':'#eee',
          //'stroke-opacity':0.1
        });
      };
      for (var tmpI = 0; tmpI<tmpLen; tmpI++ )
      {
        // bars
        app.built.timegraphBars[tmpI] = app.paper.rect(
            tmpPs[tmpI].barPosition.x,
            tmpPs[tmpI].barPosition.y,
            tmpPs[tmpI].xlength,
            app.dns.m_timegraphBarHeight
          );
        app.built.timegraphBars[tmpI].attr({
            'stroke':'none',
            'fill':app.config.timegraphRowColors[tmpPs[tmpI].displayrow-1],
            'fill-opacity':0.7
          });
      };

    delete tmpI; 
    delete tmpLen; 
    delete tmpPs;

    }); 

</script>
</head> 
<body>
  
  <h1>Graphical Resume experiment, using  the Raphael libary</h1>
  <p>Inspired by this <a href="http://www.flickr.com/photos/bulooji/3366979462/sizes/l/">graphical resume design</a></p>
  <p>Sorry, it's still lacking an input GUI, but if you know how to edit JSON, you can open this up and make your own graph quite easily.</p>
  <div id="paper1"></div>

</body>
</html>
